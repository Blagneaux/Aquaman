from pathlib import Path

import matplotlib.pyplot as plt
import numpy as np

gap_list = [0.44, 0.85, 1.27, 1.68, 2.11, 2.52, 2.94, 3.35, 3.77, 4.19, 8.87, 9.50]
Re_list = [1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000, 9000, 10000]
ref_error = 17.83062946122619

# gap / cylinder diameter in high resolution

index99_mean_high_rez_h = [61, 78.7, 80.5, 75.5, 74.8, 75.9, 69.4, 69.4, 73, 66.4, 27.5, 34]
index95_mean_high_rez_h = [35.1, 44.6, 44.9, 42.2, 43.2, 43.4, 39.3, 39.3, 41.7, 37.2, 15.1, 19.4]
nrj_first_mode_mean_high_rez_h = [0.2587364835745729, 0.21661574260651958, 0.21310355894883942, 0.20860300544136787, 0.17526942895002812, 0.18415323748986162, 0.1858295097436342, 0.18140208756762868, 0.17946475852808905, 0.1670758155358055, 0.30335692392087615, 0.27431029626127246]
erro_mean_high_rez_h = [568.5098852373051, 359.784897677383, 289.08635939557286, 273.26789728538023, 167.3969329686625, 177.46410571841756, 182.0873945532893, 141.4049188731822, 156.12852387542, 114.32655034344594, 65.60984316137417, 69.3526088077866]
error_reconstruction_list_high_rez_h = [[473.77578611773856, 295.9526495634245, 240.99710729915657, 235.6694570234313, 146.3544337350079, 141.30469692969817, 117.81466677296496, 124.36573088985442, 127.6954308772065, 96.61086791709297, 60.63522932858184, 58.57851387011206], 
 [535.3556935311206, 328.8412791018296, 262.50725527642055, 260.3314176531533, 155.27224162254305, 163.99422652898372, 182.4246122873599, 141.93663439218344, 144.21867895814722, 108.56712416791852, 60.63515769735366, 66.12510174848084], 
 [559.4725325184057, 343.4042798428596, 276.9765392527093, 259.91642974058254, 161.89705848257543, 173.5228165004364, 196.1348205404612, 141.94793140553728, 151.7390246852045, 113.22042441949544, 62.272018290649875, 67.89020742884323], 
 [572.3919052419145, 353.1754218073767, 288.5944291702653, 270.1471463946713, 167.304053318778, 178.88063356377083, 197.70548979637772, 142.47353346083975, 156.24296004861858, 115.65145279752139, 64.66341640918303, 69.25529193992452], 
 [580.2785184186591, 358.98659889050305, 298.0648141728029, 278.44978734882574, 170.43818405503916, 182.3866427797634, 193.970368116583, 143.21283439406514, 159.54270117013957, 116.90235167919222, 65.01745412059869, 70.07223514468794], 
 [585.8309079654974, 362.8033924799056, 301.6286286702716, 281.70543036351665, 172.41261259624105, 184.30534236177184, 190.98769813649506, 143.5086877904318, 161.4992361740985, 117.49412828456937, 66.64239194133182, 70.76817401255708], 
 [590.6102217261829, 366.675192589272, 303.1763737302704, 284.625122448958, 173.63424006388422, 185.98535149633398, 188.09766982445032, 143.8052111816476, 163.17423868018534, 118.01529830367105, 69.83904524417494, 71.53266792210749], 
 [593.3545203343426, 375.4446039026396, 305.5525838084526, 286.1044403198885, 174.677157971472, 187.25079240434246, 186.05659408239185, 144.12655732047799, 164.72088030495195, 118.56388367917549, 70.60130698533496, 72.88253351173502], 
 [595.8498911253197, 404.98157172723205, 307.0487712343432, 287.2974413095016, 175.72378247832276, 188.2341073451048, 184.09796678365092, 144.30230445676548, 165.78907579219924, 119.0087176543524, 68.24603281631396, 73.24197362178991], 
 [598.178875393869, 407.58398686878735, 306.31709134103613, 288.4323002512734, 176.25556536276156, 188.77644727397004, 183.58405919215804, 144.36976344001923, 166.66301206344846, 119.2312545314706, 67.54637878021894, 73.17938887762784]
]

# plt.figure()
# plt.title("RMSE of the reconstruction of the flow with 99% of the energy with respect to the \n  normalized gap between the center of the cylinder and the wall, at a fixed Reynolds number")
# for i in range(len(error_reconstruction_list_high_rez_h)):
#     elmt = error_reconstruction_list_high_rez_h[i]
#     print(gap_list, elmt)
#     plt.plot(gap_list, elmt, label=f"Re={Re_list[i]}", marker='o', linestyle='dashed')
# plt.plot(gap_list, [ref_error]*len(gap_list), label="Reference")
# plt.xlabel("Distance between the center of the cylinder and the wall over the diameter of the cylinder")
# plt.xticks(gap_list)
# plt.ylabel("Mean RMSE of reconstruction with 99% of the energy")
# plt.legend()
# plt.show()

# gap / cylinder diameter in low resolution

index99_mean_low_rez_h = [81.7, 76.6, 77.8, 80.8, 73.3, 72.9, 74.6, 77.7, 76.9, 75.4, 64.4, 68.7]
index95_mean_low_rez_h = [44.7, 38.3, 39.6, 44.9, 40.8, 40.4, 42.3, 42.8, 42.9, 43.3, 38, 40.3]
nrj_first_mode_mean_high_rez_h = [0.20577368317080652, 0.2954658514665997, 0.275558465038085, 0.24907035368039854, 0.2533944522042448, 0.24342076424973674, 0.23981887144673217, 0.21911706991544555, 0.21244702225907464, 0.2229785658155923, 0.17047967661456606, 0.18511190852834078]
erro_mean_low_rez_h = [374.63548981075076, 670.4622507758546, 534.3706547190831, 387.09897393882216, 392.89653944446377, 364.99638563342523, 310.54475893196525, 292.8664738438183, 274.3660427365926, 268.9162459848906, 173.4644352770631, 194.42436417063152]
error_reconstruction_list_low_rez_h = [[354.9097735353024, 578.8585003524236, 473.2435051631374, 363.2903304295317, 326.4513754905884, 313.53767657494694, 257.75413885268307, 286.50397870957266, 265.4485678995843, 220.80661720764164, 131.97362611018406, 158.24999011345952], 
 [371.541863062873, 639.9878943607164, 513.8138123061409, 377.78655029155146, 376.3961993978377, 345.0174932099292, 293.0629350132971, 288.33462761423493, 262.0531019612368, 272.41045345486845, 152.24163378475163, 208.94226080397323], 
 [372.3765410274592, 662.4651852412437, 528.7235050255562, 385.00874206645165, 393.0565279234382, 358.9970831320071, 305.69070282193445, 282.0409567680048, 265.0533629384769, 276.61746193212366, 171.6992293912002, 202.60245349963503], 
 [381.1326587947824, 674.7792671447228, 536.8812058661539, 388.0752255832096, 398.9540294818964, 366.8353905600009, 313.32903571740337, 287.92492518748753, 272.53990192190855, 275.07574918801174, 169.1203132110861, 198.59315384029858], 
 [383.40217473725676, 681.4537023706716, 542.7306894839122, 390.4291937001854, 402.2520446993167, 371.61195901693077, 317.778652511575, 291.9880330639727, 276.99850782969656, 275.453596873175, 177.41470654091867, 196.01075070222993], 
 [379.34338145057666, 686.9009209520067, 545.1530298813067, 392.31445184283353, 404.0335239564052, 374.597627904182, 320.4714419731712, 294.7363280322912, 278.56087851570106, 275.31801516385895, 176.01275701005238, 191.80706302856336], 
 [376.5984468558089, 691.0331201608767, 548.5592342815896, 392.5156616332237, 405.8598839756723, 377.4388015565659, 322.5533337677054, 297.7146428469288, 279.38937884422313, 273.8560263518666, 178.4580788931404, 197.21399718732155], 
 [375.64585158413377, 694.7555395857132, 550.1305360986702, 393.16975690302627, 406.3806201597975, 379.62363932877435, 323.58089304868645, 299.12672003153847, 280.3315598207937, 273.0329076610771, 199.5685923437779, 197.041562037216], 
 [375.90433119457407, 696.6288444192746, 551.858892896785, 393.635606660298, 407.5524677324778, 380.44905217281797, 325.20131732936767, 299.85612159395794, 280.974324921988, 273.3538306280721, 185.11722166472344, 196.99245792773823], 
 [375.49987586474066, 697.7595331708968, 552.612136187579, 394.76422027791, 408.02872162720774, 381.85513287809715, 326.02513828382854, 300.43840459019435, 282.3108427123169, 273.2378013882109, 193.0381938207963, 196.78995256587976]
]

# Re in low resolution

index99_mean_low_rez_Re = [68.9, 74.6, 76.3, 77.3, 77.8, 78.1, 78.3, 78.7, 78.8, 78.9]
index95_mean_low_rez_Re = [37.2, 40.8, 41.7, 42.1, 42.4, 42.9, 43, 43.1, 43.3, 43.5]
nrj_first_mode_mean_high_rez_Re = [0.25715390963717943, 0.24619300206381234, 0.24178258762691388, 0.24032714590029386, 0.23967661967779144, 0.23907103851332964, 0.23856398888296707, 0.2382777845916289, 0.23805548543435043, 0.23794353691844894]   
erro_mean_low_rez_Re = [344.0804464215412, 374.0404930672686, 383.0030068876696, 389.55273894455775, 393.4098554286693, 395.1429599672333, 396.5518530274461, 397.5778024222211, 398.54147895496135, 399.2531806980982]
error_reconstruction_list_low_rez_Re = [[354.9097735353024, 371.541863062873, 372.3765410274592, 381.1326587947824, 383.40217473725676, 379.34338145057666, 376.5984468558089, 375.64585158413377, 375.90433119457407, 375.49987586474066], 
 [578.8585003524236, 639.9878943607164, 662.4651852412437, 674.7792671447228, 681.4537023706716, 686.9009209520067, 691.0331201608767, 694.7555395857132, 696.6288444192746, 697.7595331708968], 
 [473.2435051631374, 513.8138123061409, 528.7235050255562, 536.8812058661539, 542.7306894839122, 545.1530298813067, 548.5592342815896, 550.1305360986702, 551.858892896785, 552.612136187579], 
 [363.2903304295317, 377.78655029155146, 385.00874206645165, 388.0752255832096, 390.4291937001854, 392.31445184283353, 392.5156616332237, 393.16975690302627, 393.635606660298, 394.76422027791], 
 [326.4513754905884, 376.3961993978377, 393.0565279234382, 398.9540294818964, 402.2520446993167, 404.0335239564052, 405.8598839756723, 406.3806201597975, 407.5524677324778, 408.02872162720774], 
 [313.53767657494694, 345.0174932099292, 358.9970831320071, 366.8353905600009, 371.61195901693077, 374.597627904182, 377.4388015565659, 379.62363932877435, 380.44905217281797, 381.85513287809715], 
 [257.75413885268307, 293.0629350132971, 305.69070282193445, 313.32903571740337, 317.778652511575, 320.4714419731712, 322.5533337677054, 323.58089304868645, 325.20131732936767, 326.02513828382854], 
 [286.50397870957266, 288.33462761423493, 282.0409567680048, 287.92492518748753, 291.9880330639727, 294.7363280322912, 297.7146428469288, 299.12672003153847, 299.85612159395794, 300.43840459019435], 
 [265.4485678995843, 262.0531019612368, 265.0533629384769, 272.53990192190855, 276.99850782969656, 278.56087851570106, 279.38937884422313, 280.3315598207937, 280.974324921988, 282.3108427123169], 
 [220.80661720764164, 272.41045345486845, 276.61746193212366, 275.07574918801174, 275.453596873175, 275.31801516385895, 273.8560263518666, 273.0329076610771, 273.3538306280721, 273.2378013882109]
]  

# Re in low resolution and half size crop
index99_mean_low_rez_Re_half_crop = [45.1, 48.1, 49, 49.5, 49.6, 49.9, 50.1, 50.4, 50.4, 50.4]
index95_mean_low_rez_Re_half_crop = [22.3, 23.5, 24, 24.3, 24.5, 24.6, 24.6, 24.7, 24.8, 24.8]
nrj_first_mode_mean_high_rez_Re_half_crop = [0.31440192810713957, 0.30933105548375783, 0.30729702474879367, 0.3065155606273524, 0.30612421041280596, 0.3058038093612178, 0.30546828077766885, 0.3053320208284347, 0.3051648888637474, 0.3050895751119403]
erro_mean_low_rez_Re_half_crop = [551.4762335878447, 609.3370975053609, 627.3312751017747, 637.8819071303142, 643.6984237834348, 646.9462970453404, 649.4734405183027, 651.5508188283661, 652.9297567503103, 654.0173391392257]
error_reconstruction_list_low_rez_Re_half_crop = [[629.5137897531944, 684.4416947970842, 683.1534002218563, 694.9151318762407, 699.2768762143913, 699.1260699004188, 699.0623361499987, 700.5455594807885, 700.5036355113423, 700.5350090592023], 
 [975.5143961575471, 1083.8374757428412, 1124.1122029462324, 1145.0397297546945, 1156.8450565354167, 1165.8862180108974, 1172.559476684888, 1178.397976330404, 1181.3374238109598, 1183.3184109593808], 
 [747.0466155874277, 826.7916986965627, 856.9305704588389, 872.0205213366522, 882.4488933736344, 887.6688398731645, 893.0828519811679, 896.1843411034756, 899.7478332134991, 901.5825607240781], 
 [559.7306513214519, 599.3490240398704, 616.3810489881273, 624.4737722392351, 630.0240132893408, 633.5319374085013, 635.0536956686358, 637.3071927883652, 638.2807796546683, 640.1721691598958], 
 [505.12364087784294, 577.4466993592288, 602.5182824379218, 613.0555036129845, 619.3547123390184, 622.8050448000888, 625.944589680696, 627.4559311017091, 629.2732789521742, 630.2426688747142], 
 [475.0565805189527, 534.9210970085405, 558.3719372511464, 570.8447647277701, 578.2184414522956, 583.115260886384, 587.0479362564832, 590.209372572519, 591.4165724316312, 593.2065295562685], 
 [416.5523764120019, 444.26833759926274, 457.8162430659266, 465.75361989263985, 470.73632381426927, 473.42170598718405, 475.78593179294256, 476.9429091683395, 478.7071229119485, 479.4643043595071], 
 [434.9793423657169, 476.49427685714966, 479.5397759724195, 487.83288114140464, 489.59931085104205, 490.04370980976614, 491.9674478181465, 493.3616625832787, 493.677551751913, 494.65156869571604], 
 [419.2773491353526, 443.28302769569945, 453.01088461661857, 458.457262422023, 461.52788399819184, 463.22419400074523, 463.5445974304298, 464.36579609848627, 464.5962829101451, 464.92453226049037], 
 [351.9675937489588, 422.5376432573692, 441.4784050586597, 446.42588429949734, 448.95272596674795, 450.6399897762537, 450.6855417196386, 450.737447056295, 451.7570863548214, 452.0756377430039]
]

# Re in low resolution and quarter size crop
index99_mean_low_rez_Re_quarter_crop = [30.5, 31.9, 32.5, 32.9, 33, 33.2, 33.2, 33.4, 33.5, 33.6]
index95_mean_low_rez_Re_quarter_crop = [13.7, 14.4, 14.7, 14.7, 14.9, 15, 15, 15, 15, 15]
nrj_first_mode_mean_high_rez_Re_quarter_crop = [0.34060234747827256, 0.3368325085891011, 0.33581863537868223, 0.3355308075908134, 0.3353694445446307, 0.33523477529794793, 0.3351233219322888, 0.3350811436890365, 0.33505799634245675, 0.33503202680343147]
erro_mean_low_rez_Re_quarter_crop = [610.3238577586918, 672.8037188498037, 692.9131109490212, 705.1741945538693, 711.8944565719457, 715.4702007458502, 718.5381319859911, 720.8946840793564, 722.4600119083758, 723.6852390509937]
error_reconstruction_list_low_rez_Re_quarter_crop = [[861.4680611043267, 932.574168373057, 941.624716195819, 964.2895880474571, 975.6528362462733, 977.5492883780821, 981.5085086594743, 984.4258570552713, 985.3443124477382, 986.6992175951741], 
 [938.7711124549021, 1024.5748318531835, 1056.540311398348, 1073.1013443671814, 1082.4089313055836, 1089.5470723268513, 1094.9205896607618, 1099.730789472331, 1102.0695637901026, 1103.6760724387245], 
 [770.4152774651029, 847.1071845646971, 876.0367956739326, 890.282321298143, 900.1914096495368, 904.9697815639362, 909.9915436872, 912.7695703227439, 916.3566716509908, 918.0683022807656], 
 [605.6781007585797, 656.5056813727514, 676.6689429211716, 686.5126704809383, 692.7965797001445, 696.5475357727545, 698.7674901809701, 701.2752573557369, 702.5069871918394, 704.3674885210355], 
 [560.1666718532987, 633.6462729563457, 658.7902903451331, 669.8463249423154, 676.6108116586043, 680.3483238712963, 683.6084802109601, 685.4828455315068, 687.544476400338, 688.7514002925768], 
 [531.9973571067271, 597.7322655048002, 622.8694264284828, 636.1268749737808, 643.9446462540526, 649.3186651618851, 653.2978837248573, 656.6203737315342, 657.9348930003054, 659.7881768670978], 
 [466.0964966984175, 496.56579473100817, 510.2780524610263, 518.1460196158325, 523.113513342896, 525.7600127857124, 528.0910933164295, 529.3231932208978, 531.0050041735511, 531.683378614231], 
 [482.95705069916494, 544.4150604068086, 556.0484159354273, 566.6326231360295, 569.5345868216134, 570.6506941913044, 572.6767595648377, 574.323519781089, 574.7554584982303, 575.656355205012], 
 [477.3413716669016, 523.1510482375633, 537.602770378268, 545.0178212063013, 548.615823259522, 550.6761123327092, 551.1566328303819, 552.0624427634601, 552.366420762947, 552.6544487547447], 
 [408.34707777949643, 471.7648804978214, 492.67138775260275, 501.78635747071326, 506.0754274812306, 509.3345210739701, 511.3623380240382, 512.932991558993, 514.7163311677157, 515.5075499405749]
]

mean_error_reconstruction_list_low_rez_Re_quarter_crop_apriori = [920, 1010, 1045, 1060, 1070, 1075, 1080, 1088, 1090, 1095]

# gap / cylinder diameter in low resolution and translation crop
index99_mean_low_rez_h_translation_crop = [26.5, 25.9, 24.7, 23.6, 19.8, 18.2, 14.8, 12.8, 10.9, 10.7, 5.8, 6.8]
index95_mean_low_rez_h_translation_crop = [12.6, 14.9, 13.9, 13.8, 11.9, 10.7, 8.9, 7.7, 6, 5.9, 3, 3.9]
nrj_first_mode_mean_high_rez_h_translation_crop = [0.25675841346075545, 0.289226474440945, 0.26667634932898726, 0.2155031288725495, 0.23781555227638893, 0.2763051512110409, 0.31592274629530787, 0.3303587958467968, 0.35519789054834505, 0.35092817139264093, 0.6759982392264969, 0.6546883700026914] 
erro_mean_low_rez_h_translation_crop = [39.15786490845892, 42.43334780506965, 29.366376780782403, 20.730620902022977, 21.23210185182608, 20.248101505188433, 16.299110081883192, 16.368251955949603, 15.404018985470238, 14.609300342888764, 15.134067112777899, 14.792765289330898]
error_reconstruction_list_low_rez_h_translation_crop = [[31.271998211163748, 37.058087651307645, 24.472617306684604, 18.094639275252742, 17.834812095036717, 16.359511828745504, 13.928984882385759, 13.203138569101467, 13.617188918872252, 12.299712608806121, 13.282935251446885, 13.085059366360557], 
 [36.42323284524507, 40.52907794845775, 27.91598031374035, 19.730033559589536, 20.27965382343355, 19.034729678630075, 15.289155487835478, 15.556653461274674, 14.87266461769313, 13.81210860534053, 13.933848770876969, 14.556747650291467], 
 [37.329938823584165, 41.866981164886695, 29.097782903542193, 20.566162798011067, 21.115251877302804, 19.9875803067712, 15.951255646844759, 16.09901442506775, 15.360896830468219, 14.491058672536672, 15.163676451648426, 14.848328391777992], 
 [39.37542604962466, 42.7578881833222, 29.5276523096657, 20.805074372636078, 21.494117396250147, 20.483280746514072, 16.40681168113357, 16.686663882986455, 15.576468846292983, 14.720657867996819, 15.048643517234982, 14.991557555669063], 
 [40.59709443895188, 43.060777402814686, 30.113799397132233, 21.14913666629615, 21.649510226088985, 20.769266326611863, 16.56797994844482, 16.928446797245382, 15.711318965685285, 14.95683815066192, 15.55998917275692, 14.997758729082856], 
 [40.87563031142285, 43.2598733201102, 30.300050202087075, 21.244050025369887, 21.87451656202479, 20.985955745298714, 16.67696181570365, 16.863347343745026, 15.799627188984493, 15.04794230832119, 15.536434485649204, 14.96042309784383], 
 [41.08782052615219, 43.81055561520054, 30.431508533815457, 21.312640864775418, 21.94710802063819, 21.060507827644134, 16.966804037784264, 16.974092033583766, 15.713440413248321, 15.122251529693228, 15.754164389788931, 15.078454846496253], 
 [41.244635481971976, 43.9183299027883, 30.529725046375745, 21.362523053590557, 22.003149141717923, 21.221972774565483, 17.025331654281008, 17.065051361520826, 15.763329919995064, 15.178089159952277, 15.77873077320978, 15.112772908593533], 
 [41.63666650299483, 44.002424943046776, 30.606227998242755, 21.40297126584011, 22.044662278669296, 21.26999451417714, 17.070422251045994, 17.12795557344993, 15.797511549593617, 15.216955494481086, 15.542336634420057, 15.138542195855914], 
 [41.73620589347782, 44.0694819187617, 30.668423796537912, 21.638977138868206, 22.078237097098416, 21.30821530292614, 17.10739341337261, 17.17815611152074, 15.827742603869003, 15.247389031097798, 15.739911680746843, 15.158008151337526]
]

# gap / cylinder diameter in low resolution and translation
index99_mean_low_rez_h_translation = [36.2, 38, 39, 39, 38, 38, 38, 38, 38, 38, 38, 38]
index95_mean_low_rez_h_translation = [19, 20, 22, 22.9, 23, 24, 24, 24, 24.9, 25, 25.9, 25.9]
nrj_first_mode_mean_high_rez_h_translation = [0.2121856380206045, 0.22667412366416617, 0.21592527849960236, 0.21297245751267807, 0.20997581830489953, 0.23252339660642746, 0.2427937086481917, 0.24176013276010308, 0.2579181596339122, 0.2601014898077222, 0.26117302022051014, 0.2612069261860788]
erro_mean_low_rez_h_translation = [60.562445647309744, 50.22395606228581, 37.207944361912645, 35.44260970687276, 35.50243877605921, 37.28570453618901, 36.56660297698969, 35.56809232149959, 35.5690724461193, 34.42676059392735, 32.28721699434515, 32.264683069915804]
error_reconstruction_list_low_rez_h_translation = [[53.85757108891136, 44.195328287546594, 34.59950729770347, 33.35217624319114, 33.71900591887292, 35.050966194683696, 34.05893358695282, 33.00191711579956, 32.950523344294325, 31.903408248944864, 30.06447758432293, 30.053836830195653], 
                                                   [58.70458582482838, 48.31715914548944, 36.24100312182215, 34.79317748588573, 35.02757346154352, 36.649773188855846, 35.82159308980766, 34.68802274253542, 34.7253063862433, 33.649044004356874, 31.552107217529773, 31.546214729019976], 
                                                   [60.22708185149574, 49.57396618508188, 36.98086843129125, 35.18989857674416, 35.35947999933243, 37.196502969676146, 36.328220919892914, 35.35256255752757, 35.45827415765494, 34.21393356226286, 32.07752269136439, 32.07699950397899], 
                                                   [60.84003963055743, 50.63264309231735, 37.266125318844715, 35.57630575185161, 35.632009605918284, 37.420677315544275, 36.682141212886584, 35.66148162696865, 35.684436019586116, 34.570109883144134, 32.41453362248643, 32.406595323086016], 
                                                   [61.557671944357224, 51.064082340982274, 37.618751123448796, 35.70496772345469, 35.73996933973554, 37.5661727461331, 36.93229353281036, 35.92677039865371, 35.97466863132286, 34.699443305711284, 32.526433923404404, 32.51931407312945], 
                                                   [61.80569096770597, 51.36911236424397, 37.741575483514104, 35.78865969214825, 35.81522721720134, 37.69050618071003, 37.03885310734477, 36.05560119897618, 36.074680043586554, 34.93891699285643, 32.75456809718788, 32.59851061774122], 
                                                   [61.99387278822335, 51.58332654097061, 37.82760216742511, 35.85515835249651, 35.87055516593552, 37.74910175268986, 37.07355945341187, 36.141726213858774, 36.14492897907666, 35.00636500881923, 32.81757306093301, 32.80903733356227], 
                                                   [62.11876271871445, 51.745041552603176, 37.889147973101515, 35.902016708219946, 35.91757557103745, 37.804666776915, 37.13440040705642, 36.22743294880869, 36.18453679535478, 35.05782598408156, 32.860913468250516, 32.85114845346161], 
                                                   [62.21998710005904, 51.84965268904165, 37.93750732500769, 36.11595334273632, 35.958510242417724, 37.84643182892298, 37.282097927951874, 36.29359065982352, 36.23065058438183, 35.09857353899846, 32.887157670339306, 32.87917066634722], 
                                                   [62.29919255824449, 51.90924842458116, 37.977355376967644, 36.14778319199922, 35.98448123859733, 37.88224640775914, 37.313936531781636, 36.33181775204381, 36.262719519691665, 35.12998541009778, 32.916882607632886, 32.9060031686356]
                                                ]

def plot_rmse_vs_gap(
    error_reconstruction_list,
    gap_list,
    Re_list,
    ref_error,
    Re,
    out_base="figure1_rmse_vs_gap",
    fig_width_in=6.8,
    fig_height_in=4.2,
    ax=None,
    show=True,
    save=True,
    show_legend=True,
    legend_outside=True,
    title=None,
    second_error_reconstruction_list=None,
    first_label_prefix=None,
    second_label_prefix=None,
    second_linestyle="-",
    second_marker="s",
    second_alpha=0.9
):
    # --- Cambridge-friendly settings: editable text + min line widths ---
    plt.rcParams.update({
        "font.size": 10,                 # readable at journal size
        "axes.titlesize": 10,
        "axes.labelsize": 10,
        "xtick.labelsize": 9,
        "ytick.labelsize": 9,
        "legend.fontsize": 9,

        # IMPORTANT: keep text editable in vector outputs
        "text.usetex": False,
        "svg.fonttype": "none",
        "pdf.fonttype": 42,              # TrueType (editable if you also save PDF
        "ps.fonttype": 42,               # TrueType in EPS/PS

        # Ensure lines meet the minimum 0.5 pt requirement
        "lines.linewidth": 0.8,          # >= 0.5 pt (safe margin)
        "lines.markersize": 3.5,
        "lines.markeredgewidth": 0.6,    # >= 0.5 pt
        "axes.linewidth": 0.8,           # axes thickness
        "xtick.major.width": 0.8,
        "ytick.major.width": 0.8,
    })

    if Re:
        x = Re_list
    else:
        x = gap_list[:-2]

    own_fig = False
    if ax is None:
        fig, ax = plt.subplots(figsize=(fig_width_in, fig_height_in))
        own_fig = True
    else:
        fig = ax.figure

    if title:
        ax.set_title(title)

    def plot_series(series_list, linestyle, marker, alpha, label_prefix):
        for i in range(len(series_list)):
            y = series_list[i][:-2]
            if Re:
                base_label = f"h={gap_list[i]}"
            else:
                base_label = f"Re={Re_list[i]}"
            if label_prefix:
                label = f"{label_prefix} {base_label}"
            else:
                label = base_label
            ax.plot(
                x, y,
                label=label,
                marker=marker,
                linestyle=linestyle,
                alpha=alpha,
                markerfacecolor="none",
                markeredgewidth=0.6,  # >= 0.5 pt
            )

    # Plot primary curves
    plot_series(
        error_reconstruction_list,
        linestyle="--",
        marker="o",
        alpha=1.0,
        label_prefix=first_label_prefix
    )

    # Plot secondary curves (optional)
    if second_error_reconstruction_list is not None:
        if second_label_prefix is None:
            second_label_prefix = "Source 2"
        plot_series(
            second_error_reconstruction_list,
            linestyle=second_linestyle,
            marker=second_marker,
            alpha=second_alpha,
            label_prefix=second_label_prefix
        )

    # Reference line: thicker solid line
    ax.plot(
        x,
        [ref_error] * len(x),
        label="Reference",
        linestyle="-",
        linewidth=1.0  # safely above 0.5 pt
    )

    if Re:
        ax.set_xlabel("Reynolds number")
    else:
        ax.set_xlabel("Gap / cylinder diameter")
    ax.set_ylabel("Mean reconstruction RMSE (keeping 99% energy)")
    ax.set_xticks(x)
    ax.tick_params(axis="x", labelrotation=45)
    for label in ax.get_xticklabels():
        label.set_ha("right")

    # Grid lines also >= 0.5 pt
    ax.grid(True, linewidth=0.6)

    if show_legend:
        if legend_outside:
            # Legend: move outside plot so it doesn't cover data
            ax.legend(
                loc="center left",
                bbox_to_anchor=(1.02, 0.5),
                frameon=True
            )
        else:
            ax.legend(loc="best", frameon=True, framealpha=0.9)

    if own_fig:
        fig.tight_layout()

        if save:
            # --- Production outputs ---
            # Vector EPS (preferred)
            fig.savefig(f"{out_base}.eps", format="eps", bbox_inches="tight")

            # High-res TIFF fallback (line art => 1200 dpi)
            fig.savefig(f"{out_base}.tiff", format="tiff", dpi=1200, bbox_inches="tight")

            # Optional: PDF for easy checking (also editable text)
            fig.savefig(f"{out_base}.pdf", format="pdf", bbox_inches="tight")

        if show:
            plt.show()

    return ax


# ---- Translation vs gap: side-by-side ----
if (
    "error_reconstruction_list_low_rez_h_translation" in globals()
    and "error_reconstruction_list_low_rez_h_translation_crop" in globals()
):
    fig, axes = plt.subplots(1, 2, figsize=(10.8, 4.2), sharey=True)
    plot_rmse_vs_gap(
        error_reconstruction_list=error_reconstruction_list_low_rez_h_translation,
        gap_list=gap_list,
        Re_list=Re_list,
        ref_error=ref_error,
        Re=False,
        ax=axes[0],
        show=False,
        save=False,
        show_legend=False,
        legend_outside=False,
    )
    plot_rmse_vs_gap(
        error_reconstruction_list=error_reconstruction_list_low_rez_h_translation_crop,
        gap_list=gap_list,
        Re_list=Re_list,
        ref_error=ref_error,
        Re=False,
        ax=axes[1],
        show=False,
        save=False,
        legend_outside=False,
    )
    fig.tight_layout()
    fig.savefig("translation_side_by_side.eps", format="eps", bbox_inches="tight")
    fig.savefig("translation_side_by_side.tiff", format="tiff", dpi=1200, bbox_inches="tight")
    fig.savefig("translation_side_by_side.pdf", format="pdf", bbox_inches="tight")
    plt.show()
else:
    print(
        "Define error_reconstruction_list_low_rez_h_translation and "
        "error_reconstruction_list_low_rez_h_translation_crop to plot translation side-by-side."
    )
